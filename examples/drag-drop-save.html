<!-- http://fiddle.jshell.net/gael/GF96n/4/ -->
 <html>
<head>
    <script>


        function allowDrop(e)
        {
            e.preventDefault();
        }

        function drag(e)
        {
            //store the position of the mouse relativly to the image position
            e.dataTransfer.setData("mouse_position_x",e.clientX - e.target.offsetLeft );
            e.dataTransfer.setData("mouse_position_y",e.clientY - e.target.offsetTop  );

            e.dataTransfer.setData("image_id",e.target.id);
        }

        function drop(e)
        {
            e.preventDefault();
            var image = document.getElementById( e.dataTransfer.getData("image_id") );

            var mouse_position_x = e.dataTransfer.getData("mouse_position_x");
            var mouse_position_y = e.dataTransfer.getData("mouse_position_y");

            var canvas = document.getElementById('canvas');
            var ctx = canvas.getContext('2d');

            // the image is drawn on the canvas at the position of the mouse when we lifted the mouse button
            ctx.drawImage( image , e.clientX - canvas.offsetLeft - mouse_position_x , e.clientY - canvas.offsetTop - mouse_position_y );
        }

        function convertCanvasToImage() {
            var canvas = document.getElementById('canvas');

            var image_src = canvas.toDataURL("image/png");
            window.open(image_src);

        }

    </script>     
</head>
<body>
    <div style="float:left" >
        <div>
            <img id="img1" draggable="true" ondragstart="drag(event)" src='http://fiddle.jshell.net/img/logo.png'/>
            <img id="img2" draggable="true" ondragstart="drag(event)" src='http://fiddle.jshell.net/img/logo.png' width="100"/>
            <input type="button" onclick="convertCanvasToImage()" value="Generate Image" style="float:right"/>
        </div>
        <canvas id="canvas" crossorigin="anonymous" ondrop="drop(event)" ondragover="allowDrop(event)" width="300" height="300" style="border: 1px solid gray"></canvas>

    </div>

</body>
</html>





<!-- <html>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-alpha1/jquery.min.js"></script>

    <script>


        function allowDrop(e)
        {
            e.preventDefault();
        }

        function drag(e)
        {
            //store the position of the mouse relativly to the image position
            e.dataTransfer.setData("mouse_position_x",e.clientX - e.target.offsetLeft );
            e.dataTransfer.setData("mouse_position_y",e.clientY - e.target.offsetTop  );

            e.dataTransfer.setData("image_id",e.target.id);
        }

        function drop(e)
        {
            e.preventDefault();
            var image = document.getElementById( e.dataTransfer.getData("image_id") );

            var mouse_position_x = e.dataTransfer.getData("mouse_position_x");
            var mouse_position_y = e.dataTransfer.getData("mouse_position_y");

            var canvas = document.getElementById('canvas');
            var ctx = canvas.getContext('2d');

            // the image is drawn on the canvas at the position of the mouse when we lifted the mouse button
            ctx.drawImage( image , e.clientX - canvas.offsetLeft - mouse_position_x , e.clientY - canvas.offsetTop - mouse_position_y );
        }

        function convertCanvasToImage() {
            var canvas = document.getElementById('canvas');

            var image_src = canvas.toDataURL("image/png");
            window.open(image_src);

        }

        // function convertCanvasToImage() {
        //     var canvas = document.getElementById('canvas');

        //     var image_src = canvas.toDataURL("image/png").replace("image/png", "image/octet-stream");  // here is the most important part 
        //     window.open(image_src);
        //     // window.location.href=image_src;

        //     // var img = new Image();
        //     // img.setAttribute('crossOrigin', 'anonymous');
        //     // img.src = url;

        //     // canvas.saveAsPNG(canvas);

        // }

        // var downloadButton = document.getElementById('btn-download');
        // downloadButton.addEventListener('click', function (e) {
        //     var dataURL = canvas.toDataURL('image/png');
        //     downloadButton.href = dataURL;
        // });



        // $("#btnSave").click(function() { 
        //     html2canvas($("#droppable"), {
        //         onrendered: function(canvas) {
        //             theCanvas = canvas;
        //             document.body.appendChild(canvas);

        //             // Convert and download as image 
        //             Canvas2Image.saveAsPNG(canvas); 
        //             $("#img-out").append(canvas);
        //             // Clean up 
        //             //document.body.removeChild(canvas);
        //         }
        //     });
        // });

    </script>     
</head>
<body>
    <div style="float:left" >
        <div>
            <img id="img1" draggable="true" ondragstart="drag(event)" src='http://fiddle.jshell.net/img/logo.png'>
            <img id="img2" draggable="true" ondragstart="drag(event)" src='/overlay-1.png'>
            <input type="button" onclick="convertCanvasToImage()" value="Generate Image" style="float:right"/>
            <a href="" class="button" id="btn-download" download="my-file-name.png">Download button</a>
        </div>
        <canvas id="canvas" ondrop="drop(event)" ondragover="allowDrop(event)" width="300" height="300" style="border: 1px solid gray"  />

    </div>

</body> -->